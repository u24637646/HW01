@model u24637646_HW01.Models.BookingViewModel

@{
    ViewBag.Title = "Book Ambulance";
    ViewBag.BodyClass = "booking-page";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<head>
    <title>@ViewBag.Title - SwiftMed</title>
    <link rel="stylesheet" href="~/Content/BookingStyles.css" />
</head>

<body class="@ViewBag.BodyClass">
    <div class="booking-wrapper">
        <div class="booking-container mx-auto my-5 p-4">

            @if (!string.IsNullOrEmpty(ViewBag.ServiceImagePath))
            {
                <div class="text-center mb-4">
                    <img src="@Url.Content(ViewBag.ServiceImagePath)" alt="@Model.ServiceName"
                         class="img-fluid" style="max-height: 200px; border-radius: 12px;" />
                </div>
            }

            <h2>@Model.ServiceName</h2>
            <p>Please fill in the details below to book the service.</p>

            @if (ViewBag.ErrorMessage != null)
            {
                <div id="error-popup" class="popup-overlay">
                    <div class="popup-content">
                        <button class="popup-close" onclick="document.getElementById('error-popup').style.display='none'">&times;</button>
                        <h3>Please fix these errors:</h3>
                        <p>@Html.Raw(ViewBag.ErrorMessage)</p>
                    </div>
                </div>
                <script>
                    setTimeout(() => {
                        var popup = document.getElementById('error-popup');
                        if (popup) popup.style.display = 'none';
                    }, 10000);
                </script>
            }

            @if (Model != null)
            {
                using (Html.BeginForm("SubmitBooking", "Booking", FormMethod.Post))
                {
                    @Html.HiddenFor(m => m.ServiceName)

                    <div class="row">
                        <div class="col-md-6">
                            @Html.LabelFor(m => m.FullName)
                            @Html.TextBoxFor(m => m.FullName, new { @class = "form-control", placeholder = "Name Surname" })
                        </div>
                        <div class="col-md-6">
                            @Html.LabelFor(m => m.Phone)
                            @Html.TextBoxFor(m => m.Phone, new { @class = "form-control", placeholder = "+27 00 000 0000" })
                        </div>
                    </div>

                    <div class="row mt-3">
                        <div class="col-md-6">
                            @Html.LabelFor(m => m.PickUpTime)
                            @Html.TextBoxFor(m => m.PickUpTime, "{0:HH:mm}", new { @class = "form-control", type = "time" })
                        </div>
                        <div class="col-md-6">
                            @Html.LabelFor(m => m.SelectedReasonId, "Reason")
                            @Html.DropDownListFor(m => m.SelectedReasonId, Model.Reasons ?? new List<SelectListItem>(), "Select a reason", new { @class = "form-control" })
                        </div>
                    </div>

                    <div class="row mt-3">
                        <div class="col-md-6">
                            @Html.LabelFor(m => m.SelectedVehicleId, "Vehicle")
                            @Html.DropDownListFor(m => m.SelectedVehicleId, Model.Vehicles ?? new List<SelectListItem>(), "Select a vehicle", new { @class = "form-control" })
                        </div>
                        <div class="col-md-6">
                            @Html.LabelFor(m => m.SelectedDriverId, "Driver")
                            @Html.DropDownListFor(m => m.SelectedDriverId, Model.Drivers ?? new List<SelectListItem>(), "Select a driver", new { @class = "form-control" })
                        </div>
                    </div>

                    <div class="mt-3">
                        @Html.LabelFor(m => m.Address, "Pick-Up Address")
                        @Html.TextAreaFor(m => m.Address, 4, 50, new { @class = "form-control", placeholder = "Please type your address here..." })
                    </div>

                    <div class="text-center mt-4">
                        <button type="submit" class="btn-book">BOOK AMBULANCE</button>
                    </div>
                }
            }
        </div>
    </div>
</body>
